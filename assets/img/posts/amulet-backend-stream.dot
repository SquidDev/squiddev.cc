digraph G {
  rankdir = "BT";
  clusterrank = "local";
  ordering = "in";

  subgraph cluster_2 {
    label = "go";
    labelloc = "b";

    a[label="let a = (| n, 5 |)"];

    b[label="let b = > a"];
    b -> a[weight=2];

    x[label="match b with"];
    x -> b[weight=2,pos="0,0!"];

    za[label="()"];
    za -> x[style=dashed];

    zb[label="Match Arm"];
    zb -> x[style=dashed];
  }

  subgraph cluster_1 {
    label = "Match arm";
    labelloc = "b";

    c[label="let c = to_string {int}"];

    d[label="let d = c n"]
    d -> c[weight=2];

    e[label="let e = (| d, \"!\\n\")"];
    e -> d[weight=2];

    f[label="let f = ^ e"];
    f -> e[weight=2];

    g[label="let g = io_write f"];
    g -> f[weight=2];
    g -> d[style=dashed];

    h[label="let h = (| n, 1 |)"];
    h -> g[weight=2,style=invis,shape=none];

    i[label="let i = + h"];
    i -> h[weight=2];

    y[label="go i"];
    y -> i[weight=2];
    y -> g[style=dashed];
  }
}
